--- setup.py
+++ setup.py
@@ -14,8 +14,6 @@
 import json
 import os
 import sys
-from pgadmin.model import db, User, Version, ServerGroup, Server, \
-    SCHEMA_VERSION as CURRENT_SCHEMA_VERSION

 if sys.version_info[0] >= 3:
     import builtins
@@ -27,6 +25,9 @@
     builtins.SERVER_MODE = globals()['SERVER_MODE']
 else:
     builtins.SERVER_MODE = None
+
+from pgadmin.model import db, User, Version, ServerGroup, Server, \
+    SCHEMA_VERSION as CURRENT_SCHEMA_VERSION

 # We need to include the root directory in sys.path to ensure that we can
 # find everything we need when running in the standalone runtime.


--- pgAdmin4.py
+++ pgAdmin4.py
@@ -79,6 +79,8 @@
             if path_info.startswith(script_name):
                 environ["PATH_INFO"] = path_info[len(script_name):]
         scheme = environ.get("HTTP_X_SCHEME", "")
+        if not scheme:
+            scheme = environ.get("HTTP_X_FORWARDED_PROTO", "")
         if scheme:
             environ["wsgi.url_scheme"] = scheme
         return self.app(environ, start_response)
